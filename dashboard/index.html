<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GDPR-Zero Dashboard</title>
    <style>
        body { background: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', sans-serif; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px; }
        .card { background: #1e293b; padding: 20px; border-radius: 10px; border: 1px solid #334155; }
        .metric { font-size: 32px; font-weight: bold; margin-top: 10px; }
        .green { color: #10b981; }
        .red { color: #ef4444; }
        .feed-item { background: #1e293b; margin-top: 10px; padding: 15px; border-left: 4px solid #334155; border-radius: 4px; }
        .feed-item.critical { border-left-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
    </style>
</head>
<body>
    <h1>üõ°Ô∏è GDPR-Zero Compliance Center</h1>
    <div class="grid">
        <div class="card">
            <h3>Compliance Status</h3>
            <div id="status" class="metric green">MONITORING</div>
        </div>
        <div class="card">
            <h3>Active Leaks</h3>
            <div id="leaks" class="metric green">0</div>
        </div>
        <div class="card">
            <h3>Auto-Fixed</h3>
            <div class="metric green">12</div>
        </div>
    </div>
    <div style="margin-top: 30px;">
        <h3>Live Audit Log</h3>
        <div id="feed"></div>
    </div>

    <script>
        async function refresh() {
            try {
                const res = await fetch('./data.json?t=' + Date.now());
                const data = await res.json();
                
                const statusEl = document.getElementById('status');
                const leaksEl = document.getElementById('leaks');
                
                if (data.status === 'CRITICAL') {
                    statusEl.innerText = "CRITICAL LEAK";
                    statusEl.className = "metric red";
                    leaksEl.innerText = "1";
                    leaksEl.className = "metric red";
                } else {
                    statusEl.innerText = "MONITORING";
                    statusEl.className = "metric green";
                    leaksEl.innerText = "0";
                    leaksEl.className = "metric green";
                }

                const feedDiv = document.getElementById('feed');
                feedDiv.innerHTML = data.events.map(e => `
                    <div class="feed-item ${e.type === 'LEAK_DETECTED' ? 'critical' : ''}">
                        <strong>${new Date(e.timestamp).toLocaleTimeString()}</strong>: ${e.message}
                    </div>
                `).reverse().join('');
            } catch (e) { console.log("Waiting for server..."); }
        }
        setInterval(refresh, 1000);
        refresh();
    </script>
</body>
</html>
